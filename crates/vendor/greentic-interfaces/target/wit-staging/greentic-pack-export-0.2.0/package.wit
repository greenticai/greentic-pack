// SPDX-License-Identifier: MIT

// ------------------------------------------------------------
// DEPRECATED
//
// This package is deprecated and kept for backward compatibility.
//
// Reason:
//   Superseded by the CBOR-based, self-describing model.
//
// Replacement:
//   greentic:pack@0.6.0
//
// Status:
//   No new development. No new versions will be published.
// ------------------------------------------------------------
// SPDX-License-Identifier: MIT

package greentic:pack-export@0.2.0;

interface exports {
  variant cloud { aws, gcp, azure, hetzner, local, other }
  variant platform { k8s, nomad, systemd, cfworkers, lambda, baremetal, other }

  type flow-id = string;
  use greentic:interfaces-types/types@0.1.0.{tenant-id, team-id, user-id, iface-error};

  record deployment-ctx {
    cloud: cloud,
    region: option<string>,
    platform: platform,
    runtime: option<string>,
  }

  record tenant-ctx {
    tenant: tenant-id,
    team: option<team-id>,
    user: option<user-id>,
    i18n-id: option<string>,
    deployment: deployment-ctx,
    trace-id: option<string>,
  }

  record flow-info {
    id: flow-id,
    profile: string,
    version: string,
    flow-type: string,
    private: bool,
  }

  record run-opts {
    tenant: option<tenant-ctx>,
    deployment: option<deployment-ctx>,
    timeout-ms: option<u32>,
    fuel-units: option<u64>,
  }

  record schema-doc {
    input-jsonschema: string,
    output-jsonschema: string,
  }

  record run-result {
    status: string,
    output-json: option<string>,
    error: option<string>,
    logs-json: option<string>,
    metrics-json: option<string>,
  }

  record a2a-candidate {
    flow: flow-id,
    score: f32,
  }

  // iface-error imported from greentic:interfaces-types/types@0.1.0

  list-flows: func() -> result<list<flow-info>, iface-error>;
  get-flow-schema: func(flow: flow-id) -> result<schema-doc, iface-error>;
  flow-metadata: func(flow: flow-id) -> result<string, iface-error>;
  run-flow: func(flow: flow-id, input-json: string, opts: option<run-opts>)
    -> result<run-result, iface-error>;
  prepare-flow: func(flow: flow-id, hints-json: option<string>)
    -> result<string, iface-error>;
  a2a-search: func(model: string, query-embedding: list<f32>, k: u32)
    -> result<list<a2a-candidate>, iface-error>;
}

world pack-exports {
  export exports;
}
